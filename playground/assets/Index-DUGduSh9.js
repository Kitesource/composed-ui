import{d as x,f as L,m as k,r as C,a as R,o as P,b as n,c as i,t as y,w as K}from"./index-CFjtUxAq.js";const M=1024*1024*5,j=navigator.hardwareConcurrency||4;function q(U){return new Promise((a,r)=>{const l=Math.ceil(U.size/M),d=Math.ceil(l/j),m=[];let c=0;for(let v=0;v<j;v++){const f=new Worker(new URL("/composed-ui/playground/assets/worker-BkBgHXnk.js",import.meta.url),{type:"module"}),w=v*d,b=Math.min(w+d,l);f.postMessage({file:U,start:w,end:b,CHUNK_SIZE:M}),f.onmessage=u=>{f.terminate(),m[v]=u.data,c++,c===j&&a(m.flat())},f.onerror=u=>{f.terminate(),r(u)}}})}const S=x({__name:"Index",setup(U){const a=L(),r=L([]),l=L([{name:"1.jpg",url:"https://cdn.jsdelivr.net/gh/Kitesource/resources@0.0.1/1.jpg"},{name:"Markdown.pdf",url:"https://cdn.jsdelivr.net/gh/Kitesource/resources@0.0.1/Markdown.pdf"}]),d=L([{name:"1.jpg",url:"https://cdn.jsdelivr.net/gh/Kitesource/resources@0.0.1/1.jpg"}]),m=L([{name:"Markdown.pdf",url:"https://cdn.jsdelivr.net/gh/Kitesource/resources@0.0.1/Markdown.pdf"}]);k(()=>{console.log("files",r.value)}),k(()=>{console.log("fileList",l.value)}),k(()=>{console.log("imageList",d.value)}),k(()=>{console.log("pdfList",m.value)});function c(s){return s.size>500*1024?(a.value.warning("文件必须小于 500KB"),!1):(console.log("file",s),console.log("type",s.type),s.type.includes("image")?!0:(a.value.error("只能上传图片"),!1))}function v(s){const e=["application/pdf"];return s.size>500*1024?(a.value.warning("文件必须小于 500KB"),!1):e.includes(s.type)?!0:(a.value.error("只能上传 pdf 格式的文件"),!1)}function f(s){return new Promise((e,o)=>{setTimeout(()=>{if(s.type==="application/pdf")var p={name:"Markdown.pdf",url:"https://cdn.jsdelivr.net/gh/Kitesource/resources@0.0.1/Markdown.pdf"};else var p={name:"1.jpg",url:"https://cdn.jsdelivr.net/gh/Kitesource/resources@0.0.1/1.jpg"};p?e(p):o("upload request fail ...")},1e3)})}function w(s){return new Promise((e,o)=>{console.time("sliceFile"),q(s).then(p=>{console.log("chunks",p),console.timeEnd("sliceFile"),setTimeout(()=>{if(s.type==="application/pdf")var t={name:"Markdown.pdf",url:"https://cdn.jsdelivr.net/gh/Kitesource/resources@0.0.1/Markdown.pdf"};else var t={name:"1.jpg",url:"https://cdn.jsdelivr.net/gh/Kitesource/resources@0.0.1/1.jpg"};t?e(t):o("upload request fail ...")},1e3)})})}function b(s){console.log("drop",s)}function u(s){console.log("change",s)}function B(s){console.log("preview",s)}function g(s){console.log("remove",s)}return(s,e)=>{const o=C("Upload"),p=C("Space");return P(),R("div",null,[n("h1",null,y(s.$route.name)+" "+y(s.$route.meta.title),1),e[12]||(e[12]=n("h2",{class:"mt30 mb10"},"基本使用",-1)),i(o,{fileList:r.value,"onUpdate:fileList":e[0]||(e[0]=t=>r.value=t),onDrop:b,onChange:u,onPreview:B,onRemove:g},null,8,["fileList"]),e[13]||(e[13]=n("h2",{class:"mt30 mb10"},"禁用",-1)),e[14]||(e[14]=n("h3",{class:"mb10"},"只能预览，不能删除和上传",-1)),i(o,{disabled:"",fileList:l.value,"onUpdate:fileList":e[1]||(e[1]=t=>l.value=t)},null,8,["fileList"]),e[15]||(e[15]=n("h2",{class:"mt30 mb10"},"限制数量",-1)),e[16]||(e[16]=n("h3",{class:"mb10"},"通过 maxCount 限制上传数量；当为 1 时，始终用最新上传的代替当前",-1)),i(p,{vertical:""},{default:K(()=>[i(o,{"max-count":1,tip:"maxCount: 1",fileList:r.value,"onUpdate:fileList":e[2]||(e[2]=t=>r.value=t)},null,8,["fileList"]),i(o,{"max-count":3,tip:"maxCount: 3",fileList:l.value,"onUpdate:fileList":e[3]||(e[3]=t=>l.value=t)},null,8,["fileList"])]),_:1}),e[17]||(e[17]=n("h2",{class:"mt30 mb10"},"多文件上传",-1)),e[18]||(e[18]=n("h3",{class:"mb10"},"可一次选择多个文件进行上传",-1)),i(o,{multiple:"",fileList:r.value,"onUpdate:fileList":e[4]||(e[4]=t=>r.value=t)},null,8,["fileList"]),e[19]||(e[19]=n("h2",{class:"mt30 mb10"},"自定义样式布局",-1)),e[20]||(e[20]=n("h3",{class:"mb10"},"缩略图等比覆盖；上传描述文字使用：上传",-1)),i(o,{tip:"上传",fit:"cover",fileList:l.value,"onUpdate:fileList":e[5]||(e[5]=t=>l.value=t)},null,8,["fileList"]),e[21]||(e[21]=n("h3",{class:"mt30 mb10"},"排列间距使用：'middle'；自定义上传 uploading 动画样式",-1)),i(o,{"space-props":{gap:"middle"},"spin-props":{indicator:"spin-dot",color:"#ff6900",tip:"上传中..."},fileList:l.value,"onUpdate:fileList":e[6]||(e[6]=t=>l.value=t)},null,8,["fileList"]),e[22]||(e[22]=n("h2",{class:"mt30 mb10"},"自定义操作完成的消息提示",-1)),i(o,{"action-message":{upload:"upload success",remove:"remove success"},fileList:l.value,"onUpdate:fileList":e[7]||(e[7]=t=>l.value=t)},null,8,["fileList"]),e[23]||(e[23]=n("h2",{class:"mt30 mb10"},"上传文件校验",-1)),e[24]||(e[24]=n("h3",{class:"mb10"},"上传文件最大 500KB；同时限定文件类型",-1)),i(p,{vertical:""},{default:K(()=>[i(o,{ref_key:"uploadRef",ref:a,accept:"image/*",tip:"Only Image","before-upload":c,fileList:d.value,"onUpdate:fileList":e[8]||(e[8]=t=>d.value=t),onChange:u,onRemove:g},null,8,["fileList"]),i(o,{ref_key:"uploadRef",ref:a,accept:"application/pdf",tip:"Only PDF","before-upload":v,fileList:m.value,"onUpdate:fileList":e[9]||(e[9]=t=>m.value=t),onChange:u,onRemove:g},null,8,["fileList"])]),_:1}),e[25]||(e[25]=n("h2",{class:"mt30 mb10"},"自定义上传行为",-1)),i(o,{multiple:"","upload-mode":"custom","custom-request":f,fileList:l.value,"onUpdate:fileList":e[10]||(e[10]=t=>l.value=t),onChange:u,onRemove:g},null,8,["fileList"]),e[26]||(e[26]=n("h2",{class:"mt30 mb10"},"自定义分片上传",-1)),i(o,{"upload-mode":"custom","custom-request":w,fileList:l.value,"onUpdate:fileList":e[11]||(e[11]=t=>l.value=t),onChange:u,onRemove:g},null,8,["fileList"])])}}});export{S as default};
